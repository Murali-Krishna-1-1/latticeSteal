<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Request a Quote | Lattice Steel</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Icons -->
  <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
</head>

<body class="bg-white text-gray-800">

<!-- ================= HEADER ================= -->
<div id="header"></div>

<!-- ================= HERO ================= -->
<section class="pt-32 bg-gray-100">
  <div class="max-w-6xl mx-auto px-6 py-16">
    <h1 class="text-4xl md:text-5xl font-bold text-blue-900 mb-4">
      Request a Quote
    </h1>
    <p class="text-lg text-gray-700 max-w-3xl">
      Submit your project details and drawings for steel detailing,
      estimation, or QA support. Our team will review and respond
      within one business day.
    </p>
  </div>
</section>

<!-- ================= MAIN CONTENT ================= -->
<section class="max-w-7xl mx-auto px-6 py-20 grid md:grid-cols-3 gap-14">

  <!-- ================= FORM ================= -->
  <div class="md:col-span-2 bg-white p-10 rounded-lg shadow">

    <h2 class="text-2xl font-bold text-blue-900 mb-8">
      Project Information
    </h2>

    <form id="quoteForm" class="space-y-6">

      <input type="text" name="projectName" placeholder="Project Name *" required
        class="w-full border border-gray-300 rounded-lg px-4 py-3">

      <input type="text" name="company" placeholder="Company Name"
        class="w-full border border-gray-300 rounded-lg px-4 py-3">

      <input type="email" name="email" placeholder="Email Address *" required
        class="w-full border border-gray-300 rounded-lg px-4 py-3">

      <input type="tel" name="phone" placeholder="Phone Number"
        class="w-full border border-gray-300 rounded-lg px-4 py-3">

      <select name="projectType"
        class="w-full border border-gray-300 rounded-lg px-4 py-3">
        <option value="">Project Type</option>
        <option>Commercial</option>
        <option>Industrial</option>
        <option>Warehouse</option>
        <option>Institutional</option>
        <option>Other</option>
      </select>

      <!-- SERVICES -->
      <div>
        <p class="font-medium mb-2">Services Required</p>
        <label class="block"><input type="checkbox" value="QA & Shop Drawing Review"> QA & Shop Drawing Review</label>
        <label class="block"><input type="checkbox" value="Estimation & MTO"> Estimation & MTO</label>
        <label class="block"><input type="checkbox" value="Structural Steel Detailing"> Structural Steel Detailing</label>
        <label class="block"><input type="checkbox" value="Miscellaneous Steel Detailing"> Miscellaneous Steel Detailing</label>
        <label class="block"><input type="checkbox" value="Connection Detailing"> Connection Detailing</label>
      </div>

      <input type="text" name="tonnage" placeholder="Estimated Tonnage (if known)"
        class="w-full border border-gray-300 rounded-lg px-4 py-3">

      <textarea name="details" rows="4" placeholder="Project Details"
        class="w-full border border-gray-300 rounded-lg px-4 py-3"></textarea>

      <div>
        <label class="block font-medium mb-2">Upload Drawings / Documents</label>
        <input type="file" id="files" multiple
          class="w-full border border-gray-300 rounded-lg px-4 py-2">
        <p class="text-sm text-gray-500 mt-1">
          Accepted formats: PDF, DWG, DXF, ZIP
        </p>
      </div>

      <button type="submit"
        class="bg-blue-900 text-white px-10 py-4 rounded-lg font-semibold hover:bg-blue-800 transition">
        Submit Request
      </button>

      <p id="status" class="text-sm mt-2"></p>

    </form>
  </div>

  <!-- ================= SIDEBAR ================= -->
  <div class="space-y-8">

    <div class="bg-gray-50 p-8 rounded-lg shadow">
      <h3 class="text-xl font-semibold text-blue-900 mb-4">
        Contact Information
      </h3>
      <p class="mb-2">
        ðŸ“§ <strong>Email:</strong><br>
        <a href="mailto:business@latticesteel.com" class="text-blue-900 underline">
          business@latticesteel.com
        </a>
      </p>
      <p>
        ðŸ“ž <strong>Phone:</strong><br>
        +1 (954) 751-2404
      </p>
    </div>

    <div class="bg-gray-50 p-8 rounded-lg shadow">
      <h3 class="text-xl font-semibold text-blue-900 mb-4">
        Important Notice
      </h3>
      <p class="text-gray-700">
        All services are performed per project documents.
        Engineering design and final approval remain the responsibility
        of the Engineer of Record (EOR).
      </p>
    </div>

  </div>

</section>

<!-- ================= FOOTER ================= -->
<div id="footer"></div>

<!-- ================= FORM SCRIPT ================= -->
<script>
const form = document.getElementById("quoteForm");
const statusText = document.getElementById("status");

form.addEventListener("submit", async function (e) {
  e.preventDefault();
  statusText.textContent = "Submitting requestâ€¦";

  try {
    const filesInput = document.getElementById("files");
    let filesData = [];

    for (let file of filesInput.files) {
      const base64 = await toBase64(file);
      filesData.push({
        name: file.name,
        type: file.type,
        data: base64.split(",")[1]
      });
    }

    const services = [...form.querySelectorAll('input[type="checkbox"]:checked')]
      .map(cb => cb.value);

    const payload = {
      projectName: form.projectName.value,
      company: form.company.value,
      email: form.email.value,
      phone: form.phone.value,
      projectType: form.projectType.value,
      services: services,
      tonnage: form.tonnage.value,
      details: form.details.value,
      files: filesData
    };

    const response = await fetch(
      "https://script.google.com/macros/s/AKfycbycIMChZDsKnHp5zkeIFnicV8MppvFEFL43ux6YIfMspmVnTT3eP5WzZojccudIGv7s_g/exec",
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      }
    );

    const result = await response.json();

    if (result.status === "success") {
      statusText.textContent = "âœ… Request submitted successfully!";
      form.reset();
    } else {
      throw new Error(result.message || "Submission failed");
    }

  } catch (error) {
    console.error(error);
    statusText.textContent = "âŒ Submission failed. Please try again.";
  }
});

function toBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => resolve(reader.result);
    reader.onerror = error => reject(error);
  });
}
</script>

<!-- ================= LOAD HEADER & FOOTER ================= -->
<script>
  fetch("header.html")
    .then(res => res.text())
    .then(data => document.getElementById("header").innerHTML = data);

  fetch("footer.html")
    .then(res => res.text())
    .then(data => document.getElementById("footer").innerHTML = data);
</script>

</body>
</html>
